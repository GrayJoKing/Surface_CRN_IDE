(this.webpackJsonpsurface_crn_ide=this.webpackJsonpsurface_crn_ide||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(52),c=n.n(i),u=n(12),l=n(13),s=n(23),o=n.n(s),d=n(54),f=n(53),h=n(2),p=n(3),m=n(5),v=n(4),_=n(8),j=n.n(_),b=(n(76),n(0)),O=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return Object(b.jsx)("header",{className:"grid",children:Object(b.jsxs)("nav",{className:"grid",children:[Object(b.jsx)("h2",{className:"grid title",children:"Surface CRN Simulator"}),Object(b.jsx)("h4",{className:"grid simulator_options",children:"(sim options)"}),Object(b.jsx)("h4",{className:"grid simulator_controls",children:"(sim controls)"})]})})}}]),n}(a.a.Component),g=n(24),y=n(19),x=function(){function e(t,n){Object(h.a)(this,e),this.x=void 0,this.y=void 0,this.x=t,this.y=n}return Object(p.a)(e,[{key:"add",value:function(t){return new e(this.x+t.x,this.y+t.y)}},{key:"subtract",value:function(t){return new e(this.x-t.x,this.y-t.y)}},{key:"scale",value:function(t){return new e(this.x*t,this.y*t)}}]),e}();x.origin=new x(0,0);var C=x,w=n(36),k=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(e){var r;Object(h.a)(this,n),(r=t.call(this,e)).onCellDataChanged=function(e){r.setState({data:r.state.data.map((function(t,n){return n===e.rowIndex?Object(y.a)(Object(y.a)({},t),{},Object(g.a)({},e.fieldName,Object(y.a)(Object(y.a)({},t[e.fieldName]),{},{data:e.newData}))):t}))})};var a=e.model;return r.state={columns:r.createCols(a.current_state),data:r.createData(a.current_state),colour_map:a.colour_map,grid_type:a.grid_type,offset:C.origin},r}return Object(p.a)(n,[{key:"render",value:function(){return console.log("rendAll"),Object(b.jsxs)("div",{className:"panel state_panel",children:[Object(b.jsx)("h3",{children:" Initial State "}),Object(b.jsx)(w.ReactCanvasGrid,{columns:this.state.columns,data:this.state.data,rowHeight:20,onCellDataChanged:this.onCellDataChanged})]})}},{key:"updateColsAndData",value:function(e){this.setState({columns:this.createCols(e),data:this.createData(e)})}},{key:"createCols",value:function(e){var t=[],n=0;0!==e.length&&(n=e[0].length),t.push({fieldName:"addLeftCol",width:20});for(var r=0;r<n;r++)t.push({fieldName:r.toString(),width:20});return t.push({fieldName:"addRightCol",width:20}),t}},{key:"createData",value:function(e){for(var t=this,n=[],r=-1;r<=e.length;r++){var a={};if(-1!==r&&r!==e.length)for(var i=0;i<e[0].length;i++)a[i.toString()]={data:e[r][i],getText:function(e){return e||""},renderBackground:function(e,n,r,a){if(null!==r.data){var i=t.state.colour_map.find_colour(r.data);null==i&&(i=_.Colour.white),e.fillStyle="rgb("+i.rgb().join(",")+")",e.fillRect(n.left,n.top,n.width,n.height)}},renderText:function(e,n,r){var a=Object(w.cellHasTextFunction)(r)?r.getText(r.data):r.text;if(a){var i=t.state.colour_map.find_colour(r.data);null==i&&(i=_.Colour.white);var c=i.rgb(),l=Object(u.a)(c,3),s=l[0],o=l[1],d=l[2];e.fillStyle=.299*s+.587*o+.114*d>186?"black":"white",e.fillText(a,n.left+2,n.top+10,n.width-4)}},editor:{serialise:function(e){return e||""},deserialise:function(e,t){return(e=e.trim()).match(/^\w+$/)?e:t}}};else if(0!=e.length)for(var c=0;c<e[0].length;c++)a[c.toString()]={data:null,text:"",renderBackground:function(){return 1}};a.addLeftCol={data:null,text:"",renderBackground:function(){return 1}},a.addRightCol={data:null,text:"",renderBackground:function(){return 1}},n.push(a)}return n}}]),n}(a.a.Component),N=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,e)).rules_list=void 0,r.rules_list=e,r}return Object(p.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"grid panel rules_panel",children:[Object(b.jsx)("h3",{className:"panel_header",children:" Transition Rules "}),Object(b.jsx)("div",{id:"rule_container",children:Object(b.jsx)("table",{id:"rule_list"})})]})}}]),n}(a.a.Component),E=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return Object(b.jsx)("div",{className:"grid panel options_panel",children:Object(b.jsx)("h3",{children:" Simulator Options "})})}}]),n}(a.a.Component),S=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(){return Object(h.a)(this,n),t.apply(this,arguments)}return Object(p.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{className:"grid panel colour_panel",children:[Object(b.jsx)("h3",{children:" Colour Mapping "}),Object(b.jsx)("div",{id:"colour_container",children:Object(b.jsx)("table",{id:"colour_list"})})]})}}]),n}(a.a.Component),M=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(e){return Object(h.a)(this,n),t.call(this,e)}return Object(p.a)(n,[{key:"render",value:function(){var e=this.props.import_code;return Object(b.jsxs)("div",{className:"grid panel import_export_panel",children:[Object(b.jsx)("h3",{children:" Import/Export "}),Object(b.jsxs)("div",{children:[Object(b.jsx)("input",{type:"file",id:"import_input",multiple:!0}),Object(b.jsx)("button",{type:"submit",id:"import_submit",onClick:e,children:" Import "})]})]})}}]),n}(a.a.Component),T=function(e){Object(m.a)(n,e);var t=Object(v.a)(n);function n(e){var r;return Object(h.a)(this,n),(r=t.call(this,e)).initial_state_component=null,r.state={model:new j.a({current_state:Array(5).fill(Array(5).fill("I"))})},r}return Object(p.a)(n,[{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{className:"main_grid grid",children:[Object(b.jsx)(O,{}),Object(b.jsx)(k,{model:this.state.model,ref:function(t){return e.initial_state_component=t}}),Object(b.jsx)(N,{}),Object(b.jsx)(E,{}),Object(b.jsx)(S,{}),Object(b.jsx)(M,{import_code:this.import_code.bind(this)})]})}},{key:"import_code",value:function(){var e=Object(f.a)(o.a.mark((function e(){var t,n;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null!==(t=document.getElementById("import_input").files)){e.next=3;break}return e.abrupt("return");case 3:return e.next=5,j.a.parser.parse_import_files(Object(d.a)(t));case 5:!1===(n=e.sent)||(this.setState({model:n}),this.update_page());case 7:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"update_page",value:function(){this.update_rules(this.state.model.rules),this.update_colour_map(this.state.model.colour_map),this.update_init_state(this.state.model.current_state,this.state.model.colour_map,this.state.model.grid_type)}},{key:"update_rules",value:function(e){var t=document.getElementById("rule_list");if(null!==t){t.textContent="";var n,r=Object(l.a)(e);try{for(r.s();!(n=r.n()).done;){var a,i=n.value,c=document.createElement("tr"),s=Object(l.a)([i.reactants,i.products].entries());try{for(s.s();!(a=s.n()).done;){var o,d=Object(u.a)(a.value,2),f=d[0],h=d[1];1===f&&((o=document.createElement("td")).textContent="=>",c.appendChild(o));var p,m=Object(l.a)(h.entries());try{for(m.s();!(p=m.n()).done;){var v=Object(u.a)(p.value,2),_=v[0],j=v[1];1===_&&((o=document.createElement("td")).textContent="+",c.appendChild(o)),o=document.createElement("td");var b=document.createElement("input");b.type="text",b.value=j.original_string,o.appendChild(b),c.appendChild(o)}}catch(O){m.e(O)}finally{m.f()}}}catch(O){s.e(O)}finally{s.f()}t.appendChild(c)}}catch(O){r.e(O)}finally{r.f()}}}},{key:"update_colour_map",value:function(e){var t=document.getElementById("colour_list");if(null!=t){t.textContent="";var n,r=Object(l.a)(e);try{for(r.s();!(n=r.n()).done;){var a,i=Object(u.a)(n.value,2),c=i[0],s=i[1],o=document.createElement("tr");a=document.createElement("td");var d=document.createElement("input");d.type="text",d.value=c,a.appendChild(d),o.appendChild(a),(a=document.createElement("td")).textContent="("+s.rgb().join(",")+")",o.appendChild(a);var f,h=Object(l.a)(s.species);try{for(h.s();!(f=h.n()).done;){var p=f.value;a=document.createElement("td"),(d=document.createElement("input")).type="text",d.value=p.original_string,a.appendChild(d),o.appendChild(a)}}catch(m){h.e(m)}finally{h.f()}t.appendChild(o)}}catch(m){r.e(m)}finally{r.f()}}}},{key:"update_init_state",value:function(e,t,n){this.initial_state_component.setState({current_state:e,colour_map:t,grid_type:n}),this.initial_state_component.updateColsAndData(e)}}]),n}(a.a.Component);c.a.render(Object(b.jsxs)(a.a.StrictMode,{children:[Object(b.jsx)("title",{children:" Surface CRN Simulator "}),Object(b.jsx)(T,{})]}),document.getElementById("root"))},37:function(e,t,n){"use strict";var r=n(9),a=n(26);Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t){if(r(this,e),this.original_string=t,null!==t.match(/\\(\d|\(\d+\))/))throw Error();t=t.replace(/\\\((\d+)\)/g,"(?:\\$1)"),this.matcher="^(?:"+t+")$"}return a(e,[{key:"includes",value:function(e){return null!==new RegExp(this.matcher).exec(e)}},{key:"is_pure",value:function(){return null===this.original_string.match(/^\w+$/)}}]),e}();t.default=i},38:function(e,t,n){"use strict";var r=n(9);Object.defineProperty(t,"__esModule",{value:!0});t.default=function e(t){r(this,e),this.is_mono=!0,this.reactants=[],this.products=[],this.rate=1,Object.assign(this,t)}},45:function(e,t,n){"use strict";var r=n(9),a=n(26);Object.defineProperty(t,"__esModule",{value:!0});var i=function(){function e(t){r(this,e),this.red=0,this.green=0,this.blue=0,this.species=[],this.name="",Object.assign(this,t)}return a(e,[{key:"rgb",value:function(){return[this.red,this.green,this.blue]}}]),e}();t.default=i,i.white=new i({red:256,green:256,blue:256})},60:function(e,t,n){"use strict";var r=n(39),a=n(41),i=n(9),c=n(26),u=n(42),l=n(64),s=n(65),o=n(68);Object.defineProperty(t,"__esModule",{value:!0});var d=function(e){l(n,e);var t=s(n);function n(e){var r;return i(this,n),r=t.call(this),Object.assign(u(r),e),r}return c(n,[{key:"find_colour",value:function(e){var t,n=a(this);try{for(n.s();!(t=n.n()).done;){var i=r(t.value,2),c=(i[0],i[1]);if(c.species.some((function(t){return t.includes(e)})))return c}}catch(u){n.e(u)}finally{n.f()}return null}}]),n}(o(Map));t.default=d},71:function(e,t,n){"use strict";var r=n(23),a=n(9),i=n(41),c=n(72),u=n(39),l=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(a,i){function c(e){try{l(r.next(e))}catch(t){i(t)}}function u(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,u)}l((r=r.apply(e,t||[])).next())}))},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.parse_import_files=t.parse_code=void 0;var o=s(n(37)),d=s(n(38)),f=s(n(45)),h=s(n(8));function p(e,t){var n=function(e){if(1!=(e.match(/->/g)||[]).length)return!1;var t=1,n=(e=e.replace(/\((\d+)\)/,(function(e,n){return t=+n,""}))).split("->").map((function(e){return e.split("+").map((function(e){return new o.default(e.trim())}))})),r=u(n,2),a=r[0],i=r[1];return!(a.length!=i.length||a.length>2||0==a.length)&&new d.default({reactants:a,products:i,rate:t,is_mono:1==a.length})}(e);if(!1!==n)return t.rules.push(n),!0;var r,a=function(e){var t=e.match(/^(?:\{([^}]+)\})? *((?: *[^,: ]+,? *)+) *: *\((\d+) *, *(\d+) *, *(\d+)\)$/);if(null==t)return!1;var n=t[2].split(/,\s*|\s+/).map((function(e){return new o.default(e.trim())}));return[t[1],new f.default({name:t[1],species:n,red:+t[3],green:+t[4],blue:+t[5]})]}(e);if(!1!==a)return(r=t.colour_map).set.apply(r,c(a)),!0;var i=function(e){return 1==(e.match(/=/g)||[]).length&&e.split("=").map((function(e){return e.trim()}))}(e);if(!1!==i){var l=u(i,2),s=l[0],h=l[1];return t.options.set(s,h),!0}return!1}function m(e){return e.split(/\s+|,/)}function v(e){var t,n=!1,r=new h.default,a=i(e);try{for(a.s();!(t=a.n()).done;){var c=t.value;if(""!=(c=c.trim().replace(/#.*/,"")))if(n){if("!END_INIT_STATE"==c){n=!1;continue}var u=m(c);r.current_state.push(u)}else{if("!START_INIT_STATE"==c){n=!0;continue}p(c,r)}}}catch(l){a.e(l)}finally{a.f()}return r}t.parse_code=v,t.parse_import_files=function(e){return l(this,void 0,void 0,r.mark((function t(){var n,l,s,o,d,f,h,p,m,_,j,b,O,g,y,x,C;return r.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=3;break}return console.log("No input files"),t.abrupt("return",!1);case 3:n=function e(){a(this,e),this.data=[],this.imported=!1},l=new Map,s=i(e),t.prev=7,s.s();case 9:if((o=s.n()).done){t.next=18;break}return d=o.value,f=new n,t.next=14,d.text();case 14:f.data=t.sent.split("\n").map((function(e){return e.trim().replace(/#.*/,"")})),l.set(d.name,f);case 16:t.next=9;break;case 18:t.next=23;break;case 20:t.prev=20,t.t0=t.catch(7),s.e(t.t0);case 23:return t.prev=23,s.f(),t.finish(23);case 26:h=i(l);try{for(h.s();!(p=h.n()).done;){m=u(p.value,2),m[0],_=m[1],j=i(_.data);try{for(j.s();!(b=j.n()).done;)b.value.match(/^!INCLUDE /)}catch(r){j.e(r)}finally{j.f()}}}catch(r){h.e(r)}finally{h.f()}O=[],g=i(l);try{for(g.s();!(y=g.n()).done;)x=u(y.value,2),x[0],(C=x[1]).imported||O.push.apply(O,c(C.data))}catch(r){g.e(r)}finally{g.f()}return t.abrupt("return",v(O));case 32:case"end":return t.stop()}}),t,null,[[7,20,23,26]])})))}},76:function(e,t,n){},8:function(e,t,n){"use strict";var r=n(9),a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Colour=t.Colour_Map=t.Transition_Rule=t.Species_Matcher=void 0;var i=a(n(37));t.Species_Matcher=i.default;var c=a(n(38));t.Transition_Rule=c.default;var u=a(n(60));t.Colour_Map=u.default;var l=a(n(45));t.Colour=l.default;var s=n(71),o=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};r(this,e),this.current_state=[],this.rules=[],this.colour_map=new u.default,this.options=new Map,this.grid_type="square",Object.assign(this,t)};t.default=o,o.parser={parse_import_files:s.parse_import_files,parse_code:s.parse_code}}},[[102,1,2]]]);
//# sourceMappingURL=main.9dc6f580.chunk.js.map